@tailwind base;
@tailwind components;
@tailwind utilities;

:root {
    --foreground-rgb: 0, 0, 0;
    --background-start-rgb: 214, 219, 220;
    --background-end-rgb: 255, 255, 255;
}

@media (prefers-color-scheme: dark) {
    :root {
        --foreground-rgb: 255, 255, 255;
        --background-start-rgb: 0, 0, 0;
        --background-end-rgb: 0, 0, 0;
    }
}

@layer utilities {
    .text-balance {
        text-wrap: balance;
    }

    /* Custom scrollbar styles for code blocks */
    .code-scrollbar,
    .code-scrollbar pre,
    .shiki,
    .shiki pre {
        scrollbar-width: thin;
        scrollbar-color: transparent transparent;
        scrollbar-gutter: stable;
        transition: scrollbar-color 0.2s ease;
    }

    /* Show scrollbar on hover */
    .code-scrollbar:hover,
    .code-scrollbar:hover pre,
    .shiki:hover,
    .shiki:hover pre,
    .code-block-container:hover .code-scrollbar,
    .code-block-container:hover .code-scrollbar pre,
    .code-block-container:hover .shiki,
    .code-block-container:hover .shiki pre {
        scrollbar-color: #71717a #2d3748;
    }

    /* WebKit scrollbar styles (Chrome, Safari, Edge) */
    .code-scrollbar::-webkit-scrollbar,
    .code-scrollbar pre::-webkit-scrollbar,
    .shiki::-webkit-scrollbar,
    .shiki pre::-webkit-scrollbar {
        height: 12px;
        width: 12px;
    }

    .code-scrollbar::-webkit-scrollbar-track,
    .code-scrollbar pre::-webkit-scrollbar-track,
    .shiki::-webkit-scrollbar-track,
    .shiki pre::-webkit-scrollbar-track {
        background: transparent;
        border-radius: 6px;
    }

    .code-scrollbar::-webkit-scrollbar-thumb,
    .code-scrollbar pre::-webkit-scrollbar-thumb,
    .shiki::-webkit-scrollbar-thumb,
    .shiki pre::-webkit-scrollbar-thumb {
        background-color: transparent;
        border-radius: 6px;
        border: 2px solid transparent;
        background-clip: content-box;
        transition: background-color 0.2s ease;
    }

    /* Show webkit scrollbar on hover */
    .code-scrollbar:hover::-webkit-scrollbar-thumb,
    .code-scrollbar:hover pre::-webkit-scrollbar-thumb,
    .shiki:hover::-webkit-scrollbar-thumb,
    .shiki:hover pre::-webkit-scrollbar-thumb,
    .code-block-container:hover .code-scrollbar::-webkit-scrollbar-thumb,
    .code-block-container:hover .code-scrollbar pre::-webkit-scrollbar-thumb,
    .code-block-container:hover .shiki::-webkit-scrollbar-thumb,
    .code-block-container:hover .shiki pre::-webkit-scrollbar-thumb {
        background-color: #71717a;
    }

    .code-scrollbar:hover::-webkit-scrollbar-track,
    .code-scrollbar:hover pre::-webkit-scrollbar-track,
    .shiki:hover::-webkit-scrollbar-track,
    .shiki:hover pre::-webkit-scrollbar-track,
    .code-block-container:hover .code-scrollbar::-webkit-scrollbar-track,
    .code-block-container:hover .code-scrollbar pre::-webkit-scrollbar-track,
    .code-block-container:hover .shiki::-webkit-scrollbar-track,
    .code-block-container:hover .shiki pre::-webkit-scrollbar-track {
        background: #2d3748;
    }

    .code-scrollbar:hover::-webkit-scrollbar-thumb:hover,
    .code-scrollbar:hover pre::-webkit-scrollbar-thumb:hover,
    .shiki:hover::-webkit-scrollbar-thumb:hover,
    .shiki:hover pre::-webkit-scrollbar-thumb:hover,
    .code-block-container:hover .code-scrollbar::-webkit-scrollbar-thumb:hover,
    .code-block-container:hover .code-scrollbar pre::-webkit-scrollbar-thumb:hover,
    .code-block-container:hover .shiki::-webkit-scrollbar-thumb:hover,
    .code-block-container:hover .shiki pre::-webkit-scrollbar-thumb:hover {
        background-color: #9ca3af;
    }

    .code-scrollbar::-webkit-scrollbar-corner,
    .code-scrollbar pre::-webkit-scrollbar-corner,
    .shiki::-webkit-scrollbar-corner,
    .shiki pre::-webkit-scrollbar-corner {
        background: transparent;
    }

    /* Force scrollbar visibility when content overflows */
    .code-scrollbar,
    .code-scrollbar pre,
    .shiki,
    .shiki pre {
        overflow-x: auto !important;
        overflow-y: hidden !important;
        scroll-behavior: smooth;
        min-width: 0;
        width: 100%;
    }

    /* Prevent scrollbar flickering during content updates */
    .code-block-container {
        contain: layout style;
        will-change: auto;
    }

    .code-scrollbar,
    .shiki {
        contain: layout;
        backface-visibility: hidden;
        transform: translateZ(0);
    }
}

@layer base {
    :root {
        --background: 0 0% 100%;
        --foreground: 240 10% 3.9%;
        --card: 0 0% 98%;
        --card-foreground: 240 10% 3.9%;
        --popover: 0 0% 98%;
        --popover-foreground: 240 10% 3.9%;
        --primary: 240 5.9% 10%;
        --primary-foreground: 0 0% 98%;
        --secondary: 240 4.8% 95.9%;
        --secondary-foreground: 240 5.9% 10%;
        --muted: 240 4.8% 95.9%;
        --muted-foreground: 240 3.8% 46.1%;
        --accent: 240 4.8% 95.9%;
        --accent-foreground: 240 5.9% 10%;
        --destructive: 0 84.2% 60.2%;
        --destructive-foreground: 0 0% 98%;
        --border: 240 5.9% 90%;
        --input: 240 5.9% 90%;
        --ring: 240 10% 3.9%;
        --chart-1: 12 76% 61%;
        --chart-2: 173 58% 39%;
        --chart-3: 197 37% 24%;
        --chart-4: 43 74% 66%;
        --chart-5: 27 87% 67%;
        --radius: 0.5rem;
        --sidebar-background: 0 0% 98%;
        --sidebar-foreground: 240 5.3% 26.1%;
        --sidebar-primary: 240 5.9% 10%;
        --sidebar-primary-foreground: 0 0% 98%;
        --sidebar-accent: 240 4.8% 95.9%;
        --sidebar-accent-foreground: 240 5.9% 10%;
        --sidebar-border: 240 5.9% 90%;
        --sidebar-ring: 217.2 91.2% 59.8%;
    }

    .dark {
        --background: 269 15% 13%;
        /* #201b25 - Main chat background */
        --foreground: 0 0% 95%;
        /* #f2f2f2 - Light text */
        --card: 262 25% 10%;
        /* Darker cards */
        --card-foreground: 0 0% 95%;
        --popover: 262 25% 10%;
        /* Dark popover */
        --popover-foreground: 0 0% 95%;
        --primary: 262 20% 13%;
        /* Purple primary */
        --primary-foreground: 0 0% 95%;
        --secondary: 262 25% 8%;
        /* Very dark purple */
        --secondary-foreground: 0 0% 95%;
        --muted: 262 25% 8%;
        /* Muted very dark purple */
        --muted-foreground: 0 0% 65%;
        /* #a6a6a6 - Muted text */
        --accent: 262 20% 15%;
        /* Accent purple */
        --accent-foreground: 0 0% 95%;
        --destructive: 0 62.8% 30.6%;
        --destructive-foreground: 0 0% 98%;
        --border: 262 15% 20%;
        /* Purple borders */
        --input: 262 25% 8%;
        /* Dark input background */
        --ring: 0 0% 83.9%;
        --chart-1: 220 70% 50%;
        --chart-2: 0 0% 45%;
        --chart-3: 30 80% 55%;
        --chart-4: 280 65% 60%;
        --chart-5: 340 75% 55%;
        --sidebar-background: 300 13% 9%;
        /* #1b1219 - Sidebar and header background */
        --sidebar: 262 25% 8%;
        /* #1b1219 - Sidebar background */
        --sidebar-foreground: 0 0% 90%;
        /* #e6e6e6 - Sidebar text */
        --sidebar-primary: 0 0% 95%;
        --sidebar-primary-foreground: 262 25% 8%;
        --sidebar-accent: 262 20% 15%;
        /* Sidebar accent */
        --sidebar-accent-foreground: 0 0% 90%;
        --sidebar-border: 262 15% 20%;
        /* Sidebar borders */
        --sidebar-ring: 0 0% 59.8%;
    }
}

@layer base {
    * {
        @apply border-border;
    }

    body {
        @apply bg-background text-foreground;
    }
}

.skeleton {
    * {
        pointer-events: none !important;
    }

    *[class^="text-"] {
        color: transparent;
        @apply rounded-md bg-foreground/20 select-none animate-pulse;
    }

    .skeleton-bg {
        @apply bg-foreground/10;
    }

    .skeleton-div {
        @apply bg-foreground/20 animate-pulse;
    }
}

.ProseMirror {
    outline: none;
}

.cm-editor,
.cm-gutters {
    @apply outline-none selection:bg-muted !important;
    background-color: #1a151f !important;
    /* Code block background color */
}

.ͼo.cm-focused>.cm-scroller>.cm-selectionLayer .cm-selectionBackground,
.ͼo.cm-selectionBackground,
.ͼo.cm-content::selection {
    @apply bg-purple-200 dark:bg-purple-900/50 !important;
    /* Purple selection for dark theme */
}

.cm-activeLine,
.cm-activeLineGutter {
    @apply bg-transparent !important;
}

.cm-activeLine {
    @apply rounded-r-sm !important;
}

.cm-lineNumbers {
    @apply min-w-7;
}

.cm-foldGutter {
    @apply min-w-3;
}

.cm-lineNumbers .cm-activeLineGutter {
    @apply rounded-l-sm !important;
}

.suggestion-highlight {
    @apply bg-purple-200 hover:bg-purple-300 dark:hover:bg-purple-500/50 dark:text-purple-50 dark:bg-purple-600/40;
}

/* Shiki code highlighting styles */
.shiki {
    background-color: #1a151f !important;
    color: hsl(var(--foreground)) !important;
    border-radius: 0.5rem;
    overflow-x: auto !important;
    overflow-y: hidden !important;
}

.shiki .highlighted {
    background-color: hsl(var(--muted)) !important;
}

.shiki .line {
    padding: 0 1rem;
    white-space: nowrap;
}

.shiki .line-number {
    color: hsl(var(--muted-foreground)) !important;
    border-right: 1px solid hsl(var(--border));
    padding-right: 0.75rem;
    margin-right: 0.75rem;
}

/* Ensure code blocks have proper spacing */
pre.shiki {
    margin: 1rem 0;
    padding: 1rem 0;
    overflow-x: auto !important;
    overflow-y: hidden !important;
}

/* Compact padding for single-line code blocks */
.code-block-compact pre.shiki {
    padding: 0.5rem 0;
}

.code-block-compact .shiki .line {
    padding: 0 1rem;
    line-height: 1.3;
}


.dark .shiki .highlighted {
    background-color: hsl(var(--background)) !important;
    /* Slightly lighter purple for highlighted lines */
}

/* Table styling for dark purple theme */
.dark table {
    background-color: hsl(var(--card)) !important;
    border-color: hsl(var(--border)) !important;
}

.dark table th {
    background-color: hsl(var(--muted)) !important;
    border-color: hsl(var(--border)) !important;
    color: hsl(var(--foreground)) !important;
}

.dark table td {
    border-color: hsl(var(--border)) !important;
    color: hsl(var(--foreground)) !important;
}

.dark table tr:nth-child(even) {
    background-color: hsl(var(--muted)) !important;
}

.dark table tr:hover {
    background-color: hsl(var(--accent)) !important;
}

/* Additional purple theme elements */
.dark .markdown table {
    background-color: #0a0914;
    border: 1px solid #25242e;
    border-radius: 0.5rem;
    overflow: hidden;
}

.dark .markdown table th {
    background-color: #12111b;
    color: #f2f2f2;
    border-bottom: 1px solid #25242e;
}

.dark .markdown table td {
    border-bottom: 1px solid #25242e;
    color: #e6e6e6;
}

/* Input and textarea styling */


/* Force dark purple theme on specific components */
.dark [data-sidebar="sidebar"] {
    background-color: hsl(var(--sidebar-background)) !important;
}

.dark .bg-sidebar {
    background-color: hsl(var(--sidebar-background)) !important;
}

.dark .bg-background {
    background-color: hsl(var(--background)) !important;
}

.dark main {
    background-color: hsl(var(--background)) !important;
}

/* Ensure all sidebar elements use theme colors */
.dark [data-sidebar] {
    background-color: inherit !important;
}

.dark .bg-black {
    background-color: hsl(var(--background)) !important;
}

/* Force main chat area background */
.dark [data-sidebar="inset"],
.dark main[class*="bg-"],
.dark .relative.flex.min-h-svh {
    background-color: hsl(var(--background)) !important;
}

/* Chat header should match sidebar */
.bg-sidebar {
    background-color: hsl(var(--sidebar-background)) !important;
}

/* Force all main content areas */
.dark body {
    background-color: hsl(var(--background)) !important;
}

.dark html {
    background-color: hsl(var(--background)) !important;
}

/* New Chat Button Styling */
.new-chat-button {
    background: #411329 !important;
}

.new-chat-button:hover {
    background: #7d1f45 !important;
}

/* Sidebar Gradient Background */
.sidebar-gradient {
    background: linear-gradient(to top, #0d070c 0%, #1b1219 100%) !important;
}

/* Apply gradient to all sidebar elements */
.dark [data-sidebar="sidebar"] {
    background: linear-gradient(to top, #0d070c 0%, #1b1219 100%) !important;
}

.dark .bg-sidebar {
    background: linear-gradient(to top, #0d070c 0%, #1b1219 100%) !important;
}

/* Make sidebar menu items transparent to show gradient */
.dark [data-sidebar="menu-button"] {
    background: transparent !important;
}



.dark [data-sidebar="menu-button"][data-active="true"] {
    background: #251922 !important;
}

.dark [data-sidebar="menu-button"]:hover {
    background: #251922 !important;
}

/* Override any conflicting sidebar accent colors */
.dark [data-sidebar="menu-button"][data-active="true"]:hover {
    background: #251922 !important;
}

/* Force consistent icon button backgrounds in sidebar history */
.dark [data-sidebar="menu-item"] button:hover {
    background: #251922 !important;
}

/* Specific override for dropdown trigger buttons */
.dark [data-sidebar="menu-item"] [role="button"]:hover {
    background: #251922 !important;
}

/* Force all interactive elements in sidebar history to use same color */
.dark [data-sidebar="menu-item"] .group\/menu-item button:hover,
.dark [data-sidebar="menu-item"] [data-radix-collection-item]:hover {
    background: #251922 !important;
}

/* Make sidebar group content transparent */
.dark [data-sidebar="group-content"] {
    background: transparent !important;
}

/* Make sidebar menu transparent */
.dark [data-sidebar="menu"] {
    background: transparent !important;
}

/* Make sidebar header, content, footer transparent */
.dark [data-sidebar="header"],
.dark [data-sidebar="content"],
.dark [data-sidebar="footer"] {
    background: transparent !important;
}


.border-reflect {
  --c: 289 23% 23%;
  --min: hsl(var(--c) / 0.2);
  --max: hsl(var(--c) / 1);
  border: 2px solid transparent;
  border-radius: 6px; /* matches rounded-md */
  background: 
    linear-gradient(var(--bg-color, #372132), var(--bg-color, #372132)) padding-box,
    linear-gradient(180deg, var(--min), var(--max), var(--min)) border-box;
}

.dark .border-reflect, .boring-dark .border-reflect {
  background: 
    linear-gradient(var(--bg-color, #372132), var(--bg-color, #372132)) padding-box,
    linear-gradient(180deg, rgba(147,51,91,0), rgba(147,51,91,0.74), rgba(147,51,91,0.09)) border-box;
}

.custom-gradient {
  background-image: linear-gradient(180deg, rgba(147,51,91,0), rgba(147,51,91,0.74), rgba(147,51,91,0.09)), 
                    linear-gradient(15deg, rgba(147,51,91,0.12) 50%, rgba(147,51,91,0.74));
}

.custom-gradient:hover {
  background-image: linear-gradient(180deg, rgba(122,25,65,1), rgba(122,25,65,1)); /* hover state */
}

